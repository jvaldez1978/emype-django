{% extends "base.html" %}
{% load widget_tweaks %}
{% load static %}
{% block extrastatic %}
<style>
  /* Always set the map height explicitly to define the size of the div
   * element that contains the map. */
  #map {
    height: 300px;
  }
  /* Optional: Makes the sample page fill the window. */
  html, body {
    height: 300px;
    margin: 0;
    padding: 0;
}
.responsive {
  width: 100%;
  height: auto;
}
</style>
{% endblock %}
{% block content %}
    <!-- For demo purpose -->
    <div class="content" style="padding-top: 15px;">
      <div class="col-md-12">

          <div class="card card-outline card-info">
            <div class="card-header" style = "padding-top: 6px;padding-bottom: 0px;">
              <h4 class="card-title">
                Registro de sedes
              </h4>
              <!-- tools box -->

              <!-- /. tools -->
            </div>
            <!-- /.card-header -->
            <div class="card-body pad">
              <div class="mb-3">
                <form class="form-horizontal" >
                  <div class="box-body">

                    {% for field in formA.visible_fields %}
                      <div class="form-group row">
                        <label for="{field}" class="col-sm-3 col-form-label">{{field.label_tag}}</label>
                        {% if formA.is_bound %}
                          {% if field.errors %}
                            {% render_field field class="form-control is-invalid" %}
                            {% for error in field.errors %}
                              <div class="invalid-feedback">
                                {{ error }}
                              </div>
                            {% endfor %}
                          {% else %}
                            {% render_field field class="form-control is-valid" %}
                          {% endif %}
                        {% else %}
                        <div class="col-sm-9">
                          {% render_field field readonly="readonly" class="form-control" %}
                        </div>
                        {% endif %}

                        {% if field.help_text %}
                          <small class="form-text text-muted">{{ field.help_text }}</small>
                        {% endif %}
                      </div>
                    {% endfor %}
                    <div id="map">
                    </div>
                    <br>
                    <img src = "{{foto_url}}" class="responsive">
                    <div class="box-footer">
                    <button class="btn btn-light back-list">Regresar a la lista</button>
                  </div>
                  </div>
                </form>  
              </div>
            </div>
          </div>
      </div>
    </div>




{% endblock %}


{% block javascript %}
<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDcUZqNcqkQenRm8CLKcRDFjZl23O-UQJE">
</script>
  <script type="text/javascript">
     var locations = {{ locations|safe }};
     var bounds = new google.maps.LatLngBounds();
     let map;
     let markers = [];
     
      map = new google.maps.Map(document.getElementById('map'), {
        zoom: 17,
        center: new google.maps.LatLng(-12.046374, -77.042793),
        mapTypeId: google.maps.MapTypeId.HYBRID,
        maxZoom: 20
      });

      var infowindow = new google.maps.InfoWindow();

      var marker, i, position;
      
      for (i = 0; i < locations.length; i++) {
        position = {lat: locations[0][1], lng: locations[0][2] }
        marker = new google.maps.Marker({
          position: position,
          map: map
        });
        markers.push(marker);

        google.maps.event.addListener(marker, 'click', (function(marker, i) {
          return function() {
            infowindow.setContent(locations[i][0]);
            infowindow.open(map, marker);
          }
        })(marker, i));
      }
      map.setCenter(position);

      //map.fitBounds(bounds);
      
      function placeMarker(position, map) {
          var marker = new google.maps.Marker({
              position: position,
              map: map
          });
          //map.panTo(position);
      }
      function clearMarkers() {
        setMapOnAll(null);
      }
      function deleteMarkers() {
        clearMarkers();
        markers = [];
      }
      function setMapOnAll(map) {
        for (let i = 0; i < markers.length; i++) {
          markers[i].setMap(map);
        }
      }
      function addMarker(location) {
        const marker = new google.maps.Marker({
          position: location,
          map: map
        });
        document.getElementById("id_latitud").value = location.lat();
        document.getElementById("id_longitud").value = location.lng();

        //map.setCenter(marker.getPosition());
        markers.push(marker);
      }


        $(document).ready(function(){
            $('[data-toggle="tooltip"]').tooltip();
        });
        $(".back-list").click(function(ev){         
            ev.preventDefault();
            document.location.href = "/comun/emploclist/";
        });
</script>
{% endblock %}
          


          

